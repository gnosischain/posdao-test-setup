version: '3.8'
services:
  node:
    image: sigp/lighthouse:v2.2.1-modern
    hostname: node
    command: |
      lighthouse beacon_node
      --testnet-dir /root/sbc/config
      --port 13001
      --eth1-endpoints http://host.docker.internal:8641,http://host.docker.internal:8642
      --datadir /home/.eth2/beaconchaindata
      --http-address 0.0.0.0
      --http
      --debug-level debug
      --libp2p-addresses /dns/host.docker.internal/tcp/13002/p2p/16Uiu2HAmLCN7qTEBuknCa6R7thyTdUjALjYTpkSsrHhq3FKEL5q9,/dns/host.docker.internal/tcp/13003/p2p/16Uiu2HAm5xMT8ZbN2az5ozTXqmV1JxNh8CM9CkP9BHkPhGAJZMth
      --disable-discovery
    ports:
      - '13001:13001'
    volumes:
      - ./config:/root/sbc/config
      - ./node_db:/home/.eth2/beaconchaindata
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
        max-file: "1"
  node2:
    image: sigp/lighthouse:v2.2.1-modern
    hostname: node2
    command: |
      lighthouse beacon_node
      --testnet-dir /root/sbc/config
      --port 13002
      --eth1-endpoints http://host.docker.internal:8641,http://host.docker.internal:8642
      --datadir /home/.eth2/beaconchaindata
      --http-address 0.0.0.0
      --http
      --debug-level debug
      --libp2p-addresses /dns/host.docker.internal/tcp/13001/p2p/16Uiu2HAmN5seNB3AYkTo4qRC3oWsPTEGiR68w5suCcuqG3pSf4Ze,/dns/host.docker.internal/tcp/13003/p2p/16Uiu2HAm5xMT8ZbN2az5ozTXqmV1JxNh8CM9CkP9BHkPhGAJZMth
      --disable-discovery
    ports:
      - '13002:13002'
    volumes:
      - ./config2:/root/sbc/config
      - ./node2_db:/home/.eth2/beaconchaindata
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
        max-file: "1"
  node3:
    image: sigp/lighthouse:v2.2.1-modern
    hostname: node3
    command: |
      lighthouse beacon_node
      --testnet-dir /root/sbc/config
      --port 13003
      --eth1-endpoints http://host.docker.internal:8640
      --datadir /home/.eth2/beaconchaindata
      --debug-level debug
      --libp2p-addresses /dns/host.docker.internal/tcp/13001/p2p/16Uiu2HAmN5seNB3AYkTo4qRC3oWsPTEGiR68w5suCcuqG3pSf4Ze,/dns/host.docker.internal/tcp/13002/p2p/16Uiu2HAmLCN7qTEBuknCa6R7thyTdUjALjYTpkSsrHhq3FKEL5q9
      --disable-discovery
    ports:
      - '13003:13003'
    volumes:
      - ./config3:/root/sbc/config
      - ./node3_db:/home/.eth2/beaconchaindata
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
        max-file: "1"
  validator:
    image: sigp/lighthouse:v2.2.1-modern
    hostname: validator
    depends_on:
      - node
      - node2
    command: |
      lighthouse validator_client
      --testnet-dir /root/sbc/config
      --validators-dir /root/sbc/validators
      --beacon-nodes http://node:5052,http://node2:5052
      --graffiti-file /root/sbc/config/graffiti.yml
    volumes:
      - ./config:/root/sbc/config
      - ./validators:/root/sbc/validators
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
        max-file: "1"
